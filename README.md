
# 🌈 Rainbow Boat (彩虹船) - MBTI 深度社交桌游

**彩虹船 (Rainbow Boat)** 是一款结合 **MBTI 人格理论** 与 **荣格八维认知功能** 的交互式网页桌游。

它不仅仅是一个游戏，更是一个“心理场域”。在这里，玩家登上彩虹船，驶向海洋之心。通过投掷骰子、执行 AI 船长实时生成的社交挑战、以及互相评分，来探索自我边界，领略生命之多彩。

基于 **Blue Water Protocol (蓝海协议) 3.0**，游戏现在具备了多模态感知能力，能够通过语音、神态和行动全方位勾勒你的生命画像。

---

## 📖 玩家指南 (Player Guide)

### 1. 游戏准备 (Onboarding)
*   **建立连接**：输入你的昵称。推荐允许**摄像头权限**，拍摄一张实时照片作为头像，这将极大增强游戏的沉浸感。AI 船长也会在游戏过程中通过摄像头观察玩家的状态，生成更精准的报告。
*   **人格设定**：
    *   **老手**：直接选择你的 MBTI 类型（如 INTJ, ENFP）。
    *   **新手**：点击“**AI 帮我测**”。通过 4 道生活化的滑动场景题，AI 会分析出你最可能的 3 种人格，并给出百分比解析。每一种人格都是独特而宝贵的。
*   **游戏配置**：
    *   **AI 陪玩**：朋友不够？添加 **电脑玩家 (Bot)**。每个 Bot 都有独特的人格设定，它们会根据性格自动做出决策和幽默吐槽。

### 2. 选择你的旅程 (Game Modes)

#### 🅰️ 荣格八维模式 (Jungian Hex)
*   **核心机制**：地图由 8 种认知功能（Te, Fi, Ne, Si...）组成。
*   **潜意识导航**：系统会根据你 MBTI 的**功能栈顺序**高亮可行路径。这模拟了大脑认知流动的过程。

#### 🅱️ MBTI 十六型模式 (MBTI Square)
*   **区域划分**：地图分为四大气质区域：分析家 (NT)、外交家 (NF)、守护者 (SJ)、探险家 (SP)。
*   **中心圣地**：地图中央是 **“海洋之心”**。这里代表了人格的完整与超越。

### 3. 核心玩法循环 (Core Loop)
1.  **触发 (Trigger)**：AI 主持人会根据**当前玩家性格**、**所处格子的功能/类型**实时生成 4 个锦囊：🌱暖身、🕊️真心、🔥挑战、✨走心。
2.  **多模态行动 (Action)**：在倒计时内完成挑战。
    *   🎤 **语音采集**：支持 STT 语音转文字，记录你的真实感悟。
    *   👁️ **神态捕捉**：Vision AI 自动识别执行过程中的状态摘要。
3.  **互评 (Peer Review)**：其他玩家对你的表现打分（1-5星）。这是发现他人高光时刻的绝佳机会。

### 4. 胜利与结算
游戏结束时，AI 将结合语音意图、视觉神态和评分数据，生成一份极具深度的心理分析报告，不仅包含个人点评，更有团队动力学分析。

---

## 🛠 开发者手册 (Developer Manual)

### 1. 🌊 蓝海协议 (Blue Water Protocol)
为了解决大型 LLM 在复杂桌游中的不稳定性，本作自研了蓝海协议：
*   **1.0 鲁棒性体系**：通过 `extractJSON` 机制，实现从 AI 混合文本中精准提取业务数据。
*   **2.0 序列化压缩**：采用 **矩阵编码 (Matrix Encoding)** 将玩家对象压缩为极简字符串，节省 80% 的 Token 消耗并提升 AI 对人格特征的识别精度。
*   **3.0 多模态感知**：集成 **Vision AI (Llama 3.2 Vision / Gemini Flash)**，将 Base64 关键帧实时“翻译”为语义证据，实现了低成本的多模态诊断。

### 2. 🧠 AI 提示词工程 (Prompt Engineering)
*   **本地知识库**：在 `geminiService.ts` 中内置了 16 型人格的深度画像（最佳状态、盲点、压力反应）。
*   **动态任务生成**：AI 会针对玩家的**优势功能**设计“心流区”任务，或针对**挑战功能**设计“成长区”挑战。

### 3. 核心目录结构
```
src/
├── components/
│   ├── GameBoard.tsx    # 地图渲染核心
│   ├── Onboarding.tsx   # 玩家配置与“船长必读”
│   ├── GameReport.tsx   # 深度报告生成与展现
│   └── AIConfigModal.tsx # AI 模型热切换配置
├── services/
│   ├── geminiService.ts # 统一 AI 接口层 (核心逻辑与 Prompt 仓库)
│   └── localBotService.ts # 离线 Bot 决策逻辑
└── App.tsx              # 游戏主循环、STT 与多模态视觉调度
```

---
*航行即将开始，愿彩虹指引你们的灵魂。*
*Code is Poetry, Psychology is the Map.*
